"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),ROOT_PATH=location.origin+location.pathname;$.when($.getJSON(ROOT_PATH+"meta.json").then(function(e){return e}),$.getJSON(ROOT_PATH+"router.json").then(function(e){return e})).done(function(e,t){var r=ROOT_PATH+t.api,o=ROOT_PATH+t.feed,n={"500px":"//500px.com/:username",linkedin:"//linkedin.com/in/:username",facebook:"//facebook.com/:username",github:"//github.com/:username",instagram:"//instagram.com/:username",twitter:"//twitter.com/@:username",behance:"//behance.com/:username",dribbble:"//dribbble.com/:username",pinterest:"//pinterest.com/:username",tumblr:"//:username.tumblr.com",myspace:"//myspace.com/:username",google:"//plus.google.com/:username:id",soundcloud:"//soundcloud.com/:username",blogger:"//:username.blogspot.com",coderwall:"//coderwall.com/:username",stackoverflow:"//stackoverflow.com/users/:id/:username",stackexchange:"//:category.stackexchange.com/users/:id/:username",masterbranch:"//masterbranch.com/d/:username",reddit:"//reddit.com/user/:username",livejournal:"//:username.livejournal.com",skype:"skype::username",flickr:"//flickr.com/photos/:username",foursquare:"//foursquare.com/:username",mixcloud:"//mixcloud.com/:username",etsy:"//etsy.com/people/:username","8tracks":"//8tracks.com/:username",npm:"//npmjs.com/~:username",patreon:"//patreon.com/:username",quora:"//quora.com/profile/:username",researchgate:"//researchgate.net/profile/:username",reverbnation:"//reverbnation.com/:username",slideshare:"//slideshare.net/:username",vimeo:"//vimeo.com/:username",youtube:{channel:"//youtube.com/channel/:username:id",user:"//youtube.com/[:username, :id]"},vine:"//vine.co/:username",yelp:"//yelp.com/user_details?userid=:id",zerply:"//zerply.com/:username",trello:"//trello.com/:username",sketchfab:"//sketchfab.com/:username",bitbucket:"//bitbucket.org/:username",fundable:"//fundable.com/:username",gofundme:{profile:"//gofundme.com/profile/:username",fund:"//gofundme.com/:fund"},slack:"//:team.slack.com/",unsplash:"//unsplace.com/@:username",codepen:"//codepen.io/:username",instructables:"//instructables.com/member/:username",gitlab:"//gitlab.com/:username"},a={email:"mailto:?subject=:title&body=:description Read more at :url.",facebook:"//facebook.com/sharer/sharer.php?u=:url&quote=:description",twitter:"//twitter.com/intent/tweet?&text=:description&url=:url",linkedin:"//linkedin.com/shareArticle?url=:url&title=:title&summary=:description",pinterest:"//pinterest.com/pin/create/bookmarklet?media=:feature&url=:url&description=:description",pocket:"//getpocket.com/save?title=:title&url=:url",reddit:"//reddit.com/submit?url=:url&title=:title",tumblr:"//tumblr.com/widgets/share/tool?canonicalUrl=:url&posttyle=link&title=:title&caption=:description",google:"//plus.google.com/share?url=:url",buffer:"//buffer.com/add?text=:description&url=:url",stumpleupon:"//stumbleupon.com/submit?url=:url&title=:title",blogger:"//blogger.com/blog-this.g?u=:url&n=:title&t=:description",livejournal:"//livejournal.com/update.bml?subject=:title&event=:url",myspace:"//myspace.com/post?u=:url&t=:title&c=:description",evernote:"//evernote.com/clip.action?url=:url",flipboard:"//share.flipboard.com/bookmarklet/popout?v=2&title=:title&url:url",instapaper:"//instapaper.com/edit?url=:url&title=:title&description=:description",skype:"//web.skype.com/share?url=:url",digg:"//digg.com/submit?url=:url&title=:title"},i=function(){function e(t){_classCallCheck(this,e),this.params=$.extend({},t),this.src=r}return _createClass(e,[{key:"getFeed",value:function(){return $.getJSON(this.src+"/feed/?"+$.param(this.params))}},{key:"getPosts",value:function(){return $.getJSON(this.src+"/posts/?"+$.param(this.params))}},{key:"getPostsByTag",value:function(e){return $.getJSON(this.src+"/posts/tag/"+e+"/?"+$.param(this.params))}},{key:"getPostsByCategory",value:function(e){return $.getJSON(this.src+"/posts/category/"+e+"/?"+$.param(this.params))}},{key:"getPostsByAuthor",value:function(e){return $.getJSON(this.src+"/posts/author/"+e+"/?"+$.param(this.params))}},{key:"getPostById",value:function(e){return $.getJSON(this.src+"/posts/id/"+e+"/")}},{key:"getPostBySlug",value:function(e){return $.getJSON(this.src+"/posts/slug/"+e+"/")}},{key:"getPostsByKeywords",value:function(e){return $.getJSON(this.src+"/posts/keywords/"+e+"/")}},{key:"getTags",value:function(){return $.getJSON(this.src+"/tags/?"+$.param(this.params))}},{key:"getCategories",value:function(){return $.getJSON(this.src+"/categories/?"+$.param(this.params))}},{key:"getAuthors",value:function(){return $.getJSON(this.src+"/authors/?"+$.param(this.params))}},{key:"getAuthorByName",value:function(e){return $.getJSON(this.src+"/authors/name/"+e+"/?"+$.param(this.params))}}]),e}(),s=function(){function e(t){_classCallCheck(this,e),this.params=$.extend({},t),this.src="//graph.facebook.com",this.version="v2.11"}return _createClass(e,[{key:"getUserProfileImage",value:function(e){return this.src+"/"+this.version+"/"+e+"/picture/?"+$.param(this.params)}}]),e}(),u={id:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return"string"!=typeof e?e:e.replace(/ /g,t).toLowerCase()},date:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.date.long;if(!t)return null;var o=moment(t.date);return o.isValid()?o.format(r):null}},l={setTitle:function(e){document.title=e,m.$emit("title:changed"),m.$emit("blog:event","title:changed")},socialURL:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e.split(".");var r=n;if(e.forEach(function(e){return r=r[e]}),r){for(var o in t){var a=t[o];r.indexOf(":"+o)>-1&&(r=r.replace(":"+o,a))}return r=r.replace(/:[a-z0-9_-]+(?=:|\/|\.|)/g,"")}},shareURL:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=e.split(".");var r=a;if(e.forEach(function(e){return r=r[e]}),r){for(var o in t){var n=t[o];r.indexOf(":"+o)>-1&&(r=r.replace(":"+o,encodeURIComponent(n)))}return r=r.replace(":url",location.href),r=r.replace(/:[a-z0-9_-]+(?=:|\/|\.|)/g,"")}}},c=function(e){e=e||0;var t=this,r=new i({sort:this.sort,order:this.order,limit:this.next.limit,offset:this.next.offset});t.next={},t.more=!1,t.loading=!0,r.getPosts().then(function(r){setTimeout(function(){t.posts=[].concat(_toConsumableArray(t.posts),_toConsumableArray(r.data)),t.loading=!1},e),r.next&&(t.more=!0,t.next=r.next),m.$emit(t.$options.name.toLowerCase()+":more"),m.$emit("blog:event",t.$options.name.toLowerCase()+":more")})},m=new Vue,d=Vue.component("feed",{template:"#feed",props:["limit","sort","order"],data:function(){return{posts:[],next:{},more:!1,loading:!1}},filters:$.extend({},u),methods:$.extend({loadMore:c},l),created:function(){var t=this,r=new i({sort:this.sort,order:this.order,limit:this.limit});t.setTitle(e.title),r.getPosts().then(function(e){t.posts=e.data,e.next&&(t.more=!0,t.next=e.next),m.$emit("feed:loaded"),m.$emit("blog:event","feed:loaded")})}}),p=(Vue.component("snippet",{template:"#snippet",props:["post"],data:function(){return{}},filters:$.extend({},u),methods:$.extend({},l)}),Vue.component("post",{template:"#post",props:["id"],data:function(){return{location:location,post:{config:{},meta:{created:{},modified:{}},html:null,contents:null,filename:null,frontmatter:null,id:null,markdown:null,path:null},share:e.share}},filters:$.extend({},u),methods:$.extend({},l),created:function(){var r=this;(new i).getPostById(r.$route.params.id).then(function(o){r.post=o.data,r.setTitle(e.title+" | "+t.prefix.post+r.post.meta.title),m.$emit("post:loaded"),m.$emit("blog:event","post:loaded")})},beforeRouteUpdate:function(r,o,n){var a=this;(new i).getPostById(r.params.id).then(function(r){a.post=r.data,a.setTitle(e.title+" | "+t.prefix.post+a.post.meta.title),m.$emit("post:changed"),m.$emit("blog:event","post:changed"),n()})}})),g=Vue.component("category",{template:"#category",props:["category","limit","sort","order"],data:function(){return{posts:[],next:{},more:!1,loading:!1}},methods:$.extend({loadMore:c},l),filters:$.extend({},u),created:function(){var r=this,o=new i({limit:this.limit,sort:this.sort,order:this.order});r.setTitle(e.title+" | "+t.prefix.tag+r.$route.params.category),o.getPostsByCategory(r.$route.params.category).then(function(e){r.posts=e.data,e.next&&(r.more=!0,r.next=e.next),m.$emit("category:loaded"),m.$emit("blog:event","category:loaded")})},beforeRouteUpdate:function(r,o,n){var a=this,s=new i({limit:this.limit,sort:this.sort,order:this.order});a.setTitle(e.title+" | "+t.prefix.tag+r.params.category),s.getPostsByCategory(r.params.category).then(function(e){a.posts=e.data,e.next&&(a.more=!0,a.next=e.next),m.$emit("category:changed"),m.$emit("blog:event","category:changed"),n()})}}),h=Vue.component("tag",{template:"#tag",props:["tag","limit","sort","order"],data:function(){return{posts:[],next:{},more:!1,loading:!1}},methods:$.extend({loadMore:c},l),filters:$.extend({},u),created:function(){var r=this,o=new i({limit:this.limit,sort:this.sort,order:this.order});r.setTitle(e.title+" | "+t.prefix.tag+r.$route.params.tag),o.getPostsByTag(r.$route.params.tag).then(function(e){r.posts=e.data,e.next&&(r.more=!0,r.next=e.next),m.$emit("tag:loaded"),m.$emit("blog:event","tag:loaded")})},beforeRouteUpdate:function(r,o,n){var a=this,s=new i({limit:this.limit,sort:this.sort,order:this.order});a.setTitle(e.title+" | "+t.prefix.tag+r.params.tag),s.getPostsByTag(r.params.tag).then(function(e){a.posts=e.data,e.next&&(a.more=!0,a.next=e.next),m.$emit("tag:changed"),m.$emit("blog:event","tag:changed"),n()})}}),f=Vue.component("author",{template:"#author",props:["author","limit","sort","order"],data:function(){return{location:location,photo:null,about:{config:{},meta:{},html:null,markdown:null,frontmatter:null,path:null,filename:null,contents:null},posts:[],next:{},more:!1,loading:!1,socials:Object.keys(n)}},methods:$.extend({loadMore:c,getImageURL:function(){var e;if(console.log(this),this.about.meta.facebook&&(e=this.about.meta.facebook.id)){return new s({width:300}).getUserProfileImage(e)}}},l),filters:$.extend({},u),created:function(){var r=this,o=new i({limit:this.limit,sort:this.sort,order:this.order});r.setTitle(e.title+" | "+t.prefix.author+r.$route.params.author),$.when(o.getAuthorByName(r.$route.params.author).then(function(e){r.about=e.data,m.$emit("author:loaded:info")}),o.getPostsByAuthor(r.$route.params.author).then(function(e){r.posts=e.data,e.next&&(r.more=!0,r.next=e.next),m.$emit("author:loaded:posts")})).done(function(){m.$emit("author:loaded"),m.$emit("blog:event","author:loaded")})},beforeRouteUpdate:function(r,o,n){var a=this,s=new i({limit:this.limit,sort:this.sort,order:this.order});a.setTitle(e.title+" | "+t.prefix.author+r.params.author),$.when(s.getAuthorByName(r.params.author).then(function(e){a.about=e.data,m.$emit("author:changed:info")}),s.getPostsByAuthor(r.params.author).then(function(e){a.posts=e.data,e.next&&(a.more=!0,a.next=e.next),m.$emit("author:changed:posts")})).done(function(){m.$emit("author:changed"),m.$emit("blog:event","author:changed"),n()})}}),b=(Vue.component("loading",{template:"#loading",props:["loading"],data:function(){return{}}}),new VueRouter({routes:[{path:"/",component:d,props:{limit:10,sort:"created",order:"newest"}},{path:"/post/:id",component:p},{path:"/category/:category",component:g,props:{limit:10,sort:"created",order:"newest"}},{path:"/tag/:tag",component:h,props:{limit:10,sort:"created",order:"newest"}},{path:"/author/:author",component:f,props:{limit:10,sort:"created",order:"newest"}},{path:o,redirect:function(e){window.location=API_SRC+e.path}}]}));new Vue({router:b,el:"#blog",created:function(){m.$on("blog:event",function(e){var t=0,r=setInterval(function(){t+=10,m.$emit(e+":"+t)},10);setTimeout(function(){clearInterval(r)},1001)});var e=function(e,t,r){$(e).addClass(t),setTimeout(function(){$(e).removeClass(t)},r)};new Clipboard(".copy").on("success",function(t){e(t.trigger,"copy-success",2e3)}).on("error",function(t){e(t.trigger,"copy-error",2e3)});var r={languages:[],interpret:function(e){var t=$(e).html().trim(),r=e.className.split(/\s+/).filter(function(e){return 0===e.indexOf("language-")})[0].replace("language-","");$(e).empty();var o=$("<textarea>",{html:t,css:{"margin-top":"-99999px","margin-left":"-99999px",position:"absolute",opacity:0}}).appendTo(document.body);return t=o.val(),o.remove(),{code:t,language:r}},parse:function(e,t){return CodeMirror(e,{tabSize:2,value:t.code,mode:t.language,lineNumbers:!0,readOnly:!0,viewportMargin:1/0})},setup:function(){var e=ROOT_PATH+t.dependencies.js+"codemirror/";$("pre > code").each(function(t,o){var n=r.interpret(o);-1==r.languages.indexOf(n.language)?(r.languages.push(n.language),$(document).queue("codemirror",function(t){$.getScript(e+n.language+".js").then(function(){r.parse(o,n),t()})})):$(document).queue("codemirror",function(e){r.parse(o,n),e()})}),$(document).dequeue("codemirror")}};m.$on("post:loaded:10",r.setup),m.$on("post:changed:10",r.setup)}})});